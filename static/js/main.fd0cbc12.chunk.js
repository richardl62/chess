(this["webpackJsonpdraggable-tutorial"]=this["webpackJsonpdraggable-tutorial"]||[]).push([[0],{34:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(22),o=a.n(c),i=a(3),l=a(4),u=a(14),s=a(12),d=a(26),f=function(){function e(t,a){if(Object(i.a)(this,e),!(t instanceof Array&&"boolean"===typeof a))throw new Error("Bad input to BoardLayout");this._corePieces=t,this._topLeftBlack=a,Object.seal(this)}return Object(l.a)(e,[{key:"copy",value:function(){return new e(this._corePieces.map((function(e){return Object(d.a)(e)})),this._topLeftBlack)}},{key:"corePiece",value:function(e,t,a){if(void 0===this._corePieces[e][t])throw new Error("Invalid row or column number: ".concat(e," ").concat(t));return void 0!==a&&(this._corePieces[e][t]=a),this._corePieces[e][t]}},{key:"isBlack",value:function(e,t){return(e+t)%2===0?this._topLeftBlack:!this._topLeftBlack}},{key:"findCorePiecebyId",value:function(e){for(var t=0;t<this.nRows;++t)for(var a=0;a<this.nCols;++a){var n=this._corePieces[t][a];if(n&&n.id===e)return{row:t,col:a,piece:n}}return null}},{key:"nRows",get:function(){return this._corePieces.length}},{key:"nCols",get:function(){return this._corePieces[0].length}}]),e}(),m=a(13),h=a(39),v="piece",p=a(38),b=a(23),k=a.n(b),y=["p","n","b","r","q","k"],P=["P","N","B","R","Q","K"],g=y.concat(P),w=function e(t,a){Object(i.a)(this,e),this.id=a,this.name=t,Object.freeze(this)},E=function(){function e(){Object(i.a)(this,e),this._lastUsedId=0}return Object(l.a)(e,[{key:"make",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e)return null;if(e instanceof w)return this.make(e.name);if(!g.includes(e))throw new Error("CorePieceFactor.make() given unrecognised input: ".concat(e));return++this._lastUsedId,new w(e,this._lastUsedId)}}]),e}();function O(e){var t=e.corePiece,a=e.gameCallbacks,n=Object(p.a)({item:{type:v,id:t.id},begin:function(){return console.log("Drag begin ".concat(t.id))},end:function(e,n){return a.dragEnd(t.id,n.didDrop())}}),c=Object(m.a)(n,2)[1];return r.a.createElement("div",{className:"piece",ref:c},r.a.createElement(k.a,{piece:t.name}))}var C=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.black,a=e.children,n="square "+(t?"black-square":"white-square");return r.a.createElement("div",{className:n},a)}}]),a}(r.a.PureComponent);var _=function(e){var t=e.corePiece,a=e.gameCallbacks,n=e.isBlack,c=e.row,o=e.col,i=Object(h.a)({accept:v,drop:function(e){return a.movePiece(e.id,c,o)},collect:function(e){return{isOver:!!e.isOver()}}}),l=Object(m.a)(i,2)[1];return r.a.createElement("div",{ref:l,style:{position:"relative",width:"100%",height:"100%"}},r.a.createElement(C,{black:n},t?r.a.createElement(O,{corePiece:t,gameCallbacks:a}):null))};function j(e,t,a){var n=function(e){return a+"-"+e};t.push(r.a.createElement("div",{key:n("start")}));for(var c=1;c<=e;++c)t.push(r.a.createElement("div",{key:n(c),className:"column-number"},c));t.push(r.a.createElement("div",{key:n("end")}))}function B(e,t,a,n){var c=function(e){return"r"+t+"-"+e},o=String.fromCharCode(65+t);n.push(r.a.createElement("div",{key:c("start"),className:"row-letter"},o));for(var i=0;i<e.nCols;++i)n.push(r.a.createElement(_,{index:i,key:c(i),corePiece:e.corePiece(t,i),gameCallbacks:a,isBlack:e.isBlack(t,i),row:t,col:i}));n.push(r.a.createElement("div",{key:c("end"),className:"row-letter"},o))}function L(e){var t=e.layout,a=e.gameCallbacks,n=t.nRows,c=t.nCols,o=[];j(c,o,"top");for(var i=0;i<n;++i)B(t,i,a,o);j(c,o,"bottom");var l={display:"grid",gridTemplateColumns:"repeat(".concat(c+2,",auto)"),gridTemplateRows:"repeat(".concat(n+2,",auto)")};return r.a.createElement("div",{className:"board",style:l},o)}var N=a(37),I=a(25),R=[["r","n","b","q","k","b","n","r"],["p","p","p","p","p","p","p","p"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],["P","P","P","P","P","P","P","P"],["R","N","B","Q","K","B","N","R"]];function q(e){var t=e.corePieces,a=e.gameCallbacks;return r.a.createElement("div",{className:"permanent-pieces"},t.map((function(e,t){return r.a.createElement("div",{className:"square",index:t,key:t},r.a.createElement(O,{corePiece:e,gameCallbacks:a}))})))}function S(e,t){var a=e.map((function(e){return e.map((function(e){return t.make(e)}))}));return new f(a,e.topLeftBlack)}R.topLeftBlack=!1,Object.freeze(R);var z=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(i.a)(this,a),e=t.call(this);var n=new E;e._corePieceFactory=n,e.state={boardLayout:S(R,n)};var r=y.map((function(e){return n.make(e)})),c=P.map((function(e){return n.make(e)}));return e._OffBoardCorePieces={black:r,white:c,all:r.concat(c)},e._callbacks={movePiece:function(){var t;return(t=e).movePiece.apply(t,arguments)},dragEnd:function(){var t;return(t=e).dragEnd.apply(t,arguments)}},Object.freeze(e._OffBoardCorePieces),e}return Object(l.a)(a,[{key:"copyPiece",value:function(e){return this._corePieceFactory.make(e)}},{key:"movePiece",value:function(e,t,a){var n=this.state.boardLayout.copy(),r=n.findCorePiecebyId(e);if(r)t===r.row&&a===r.col||(n.corePiece(t,a,r.piece),n.corePiece(r.row,r.col,null));else{var c=this._OffBoardCorePieces.all.find((function(t){return t.id===e}));if(!c)throw new Error("Piece with id ".concat(e," not found"));n.corePiece(t,a,this.copyPiece(c))}this.setState({boardLayout:n})}},{key:"dragEnd",value:function(e,t){if(!t){var a=this.state.boardLayout.findCorePiecebyId(e);if(a){var n=this.state.boardLayout.copy();n.corePiece(a.row,a.col,null),this.setState({boardLayout:n})}}}},{key:"render",value:function(){return r.a.createElement(N.a,{backend:I.a},r.a.createElement("div",{className:"game"},r.a.createElement(q,{corePieces:this._OffBoardCorePieces.black,gameCallbacks:this._callbacks}),r.a.createElement(L,{layout:this.state.boardLayout,gameCallbacks:this._callbacks}),r.a.createElement(q,{corePieces:this._OffBoardCorePieces.white,gameCallbacks:this._callbacks})))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(34);var F=document.getElementById("root");o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(z,null)),F),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[35,1,2]]]);
//# sourceMappingURL=main.fd0cbc12.chunk.js.map