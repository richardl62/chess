(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(21),c=n.n(r),i=n(5),l=n(8),s=n(39),u=n(25),d=n(22),p=n(27),m=n(3),f=n(4),h=function(){function e(t,n){if(Object(m.a)(this,e),this._corePieces=void 0,this._topLeftBlack=void 0,!(t instanceof Array&&"boolean"===typeof n))throw new Error("Bad input to BoardLayout");this._corePieces=t,this._topLeftBlack=n,Object.seal(this)}return Object(f.a)(e,[{key:"copy",value:function(){return new e(this._corePieces.map((function(e){return Object(p.a)(e)})),this._topLeftBlack)}},{key:"sanityCheckRowCol",value:function(e,t){if(void 0===this._corePieces[e][t])throw new Error("Invalid row or column number: ".concat(e," ").concat(t))}},{key:"setCorePiece",value:function(e,t,n){this.sanityCheckRowCol(e,t),this._corePieces[e][t]=n}},{key:"corePiece",value:function(e,t){return this.sanityCheckRowCol(e,t),this._corePieces[e][t]}},{key:"isBlack",value:function(e,t){return(e+t)%2===0?this._topLeftBlack:!this._topLeftBlack}},{key:"findCorePiecebyId",value:function(e){for(var t=0;t<this.nRows;++t)for(var n=0;n<this.nCols;++n){var a=this._corePieces[t][n];if(a&&a.id===e)return{row:t,col:n,piece:a}}return null}},{key:"clearSquares",value:function(){var e,t=Object(d.a)(this._corePieces);try{for(t.s();!(e=t.n()).done;){e.value.fill(null)}}catch(n){t.e(n)}finally{t.f()}return this}},{key:"reserveRows",value:function(){this._topLeftBlack=this.isBlack(this.nRows-1,0);for(var e=this._corePieces,t=0;t<this.nRows/2;++t)for(var n=this.nRows-(t+1),a=0;a<this.nCols;++a){var o=e[t][a];e[t][a]=e[n][a],e[n][a]=o}return this}},{key:"nRows",get:function(){return this._corePieces.length}},{key:"nCols",get:function(){return this._corePieces[0].length}}]),e}(),b=n(28),y=n(26),v=n(41),k="piece",P=n(40),w=n(23),g=n.n(w),E=function(e){var t=e.corePiece,n=e.gameOptions,a=Object(P.a)({item:{type:k,id:t.id},collect:function(e){return{isDragging:!!e.isDragging()}},end:function(e,a){return n.dragEnd(t.id,a.didDrop())}}),r=Object(l.a)(a,2),c=r[0].isDragging,i=r[1];return c&&n.dragBehaviour(t.id).move?null:o.a.createElement("div",{className:"piece-div",ref:i},o.a.createElement(g.a,{piece:t.name}))},O=function(e){Object(b.a)(n,e);var t=Object(y.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(f.a)(n,[{key:"render",value:function(){var e=this.props.color,t=this.props.children,n="square";if(e)if("black"===e)n+=" black-square";else{if("white"!==e)throw new Error("Unrecognised square color: ".concat(e));n+=" white-square"}return o.a.createElement("div",{className:"square-placeholder"},o.a.createElement("div",{className:n},t))}}]),n}(o.a.PureComponent);function _(e){var t=e.corePiece,n=e.gameOptions,a=e.color,r=e.row,c=e.col,i=Object(v.a)({accept:k,drop:function(e){return n.movePiece(e.id,r,c)},collect:function(e){return{isOver:!!e.isOver()}}}),s=Object(l.a)(i,2)[1];return o.a.createElement("div",{ref:s,style:{position:"relative",width:"100%",height:"100%"}},o.a.createElement(O,{color:a},t?o.a.createElement(E,{corePiece:t,gameOptions:n}):null))}function B(e,t,n){var a=function(e){return n+"-"+e};t.push(o.a.createElement("div",{key:a("start")}));for(var r=0;r<e;++r)t.push(o.a.createElement("div",{key:a(r),className:"board-boarder board-boarder-letter"},String.fromCharCode(65+r)));t.push(o.a.createElement("div",{key:a("end")}))}function C(e,t,n,a){var r=function(e){return"r"+t+"-"+e},c=function(a){return o.a.createElement("div",{key:r(a),className:"board-boarder board-boarder-number"},n.numberRowsFromTop?t+1:e.nRows-t)},i=function(a){return o.a.createElement(_,{key:r(a),corePiece:e.corePiece(t,a),gameOptions:n,color:e.isBlack(t,a)?"black":"white",row:t,col:a})};a.push(c("start"));for(var l=0;l<e.nCols;++l)a.push(i(l));a.push(c("end"))}function R(e){var t=e.layout,n=e.gameOptions,a=t.nRows,r=t.nCols,c=[];B(r,c,"top");for(var i=0;i<a;++i)C(t,i,n,c);B(r,c,"bottom");var l={display:"grid",gridTemplateColumns:"repeat(".concat(r+2,",auto)"),gridTemplateRows:"repeat(".concat(a+2,",auto)")};return o.a.createElement("div",{className:"board",style:l},c)}var j=function e(t,n){Object(m.a)(this,e),this.name=void 0,this.id=void 0,this.id=n,this.name=t,Object.freeze(this)},L=function(){function e(){Object(m.a)(this,e),this._lastUsedId=void 0,this._lastUsedId=0}return Object(f.a)(e,[{key:"make",value:function(e){return++this._lastUsedId,new j(e,this._lastUsedId)}},{key:"copy",value:function(e){return this.make(e.name)}}]),e}(),N={standard:{copyableTop:["p","n","b","r","q","k"],board:[["r","n","b","q","k","b","n","r"],["p","p","p","p","p","p","p","p"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],["P","P","P","P","P","P","P","P"],["R","N","B","Q","K","B","N","R"]],topLeftBlack:!1,copyableBottom:["P","N","B","R","Q","K"],displayName:"Standard"},fiveASide:{copyableTop:["p","n","b","r","q","k"],board:[["r","n","b","q","k"],["p","p","p","p","p"],[null,null,null,null,null],[null,null,null,null,null],["P","P","P","P","P"],["R","N","B","Q","K"]],topLeftBlack:!1,copyableBottom:["P","N","B","R","Q","K"],displayName:"5-a-side"},test:{copyableTop:["p"],board:[["p"],[null],["P"]],topLeftBlack:!1,copyableBottom:["P"],displayName:"test"}},I=Object.keys(N);var T=function(e){var t=e.gameOptions,n=t.boardLayoutName();return o.a.createElement("div",{className:"game-control"},o.a.createElement("div",{className:"game-type"},I.map((function(e){return o.a.createElement("div",{key:e},o.a.createElement("input",{type:"radio",name:"game-type",id:e,onChange:function(){return t.setBoardLayout(e)},checked:n===e}),o.a.createElement("label",{htmlFor:e},N[e].displayName.replace("o","&#8209;")))}))),o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{type:"button",onClick:function(){return t.clear()}}," Clear"),o.a.createElement("button",{type:"button",onClick:function(){return t.flip()}},"Flip")),o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{type:"button",disabled:!t.canUndo,onClick:function(){return t.undo()}},"Undo"),o.a.createElement("button",{type:"button",disabled:!t.canRedo,onClick:function(){return t.redo()}},"Redo"),o.a.createElement("button",{type:"button",disabled:!t.canUndo,onClick:function(){return t.restart()}},"Restart")))},U=function(){function e(t){Object(m.a)(this,e),this._states=void 0,this._stateIndex=void 0,this._states=[t],this._stateIndex=0}return Object(f.a)(e,[{key:"undo",value:function(){if(!this.canUndo)throw new Error("StateManager Cannot undo");return--this._stateIndex,this.state}},{key:"redo",value:function(){if(!this.canRedo)throw new Error("StateManager Cannot redo");return++this._stateIndex,this.state}},{key:"restart",value:function(){return this._stateIndex=0,this.state}},{key:"setState",value:function(e){var t=Object(i.a)(Object(i.a)({},this.state),e);this._states=this._states.slice(0,this._stateIndex+1),this._states.push(t),++this._stateIndex}},{key:"canUndo",get:function(){return this._stateIndex>0}},{key:"canRedo",get:function(){return this._stateIndex+1<this._states.length}},{key:"state",get:function(){return this._states[this._stateIndex]}}]),e}();function q(e){var t=e.corePieces,n=e.gameOptions;return o.a.createElement("div",{className:"row-of-pieces"},t.map((function(e,t){return o.a.createElement(O,{key:t},e?o.a.createElement(E,{corePiece:e,gameOptions:n}):null)})))}function S(e,t){var n=function(e){return e?t.make(e):null},a=N[e];if(!a)throw new Error("Unrecognised layout name: ".concat(e));var o=a.board.map((function(e){return e.map(n)}));return{copyablePiecesTop:a.copyableTop.map(n),boardLayout:new h(o,a.topLeftBlack),copyablePiecesBottom:a.copyableBottom.map(n),layoutName:e}}var x,F=new L,D=function(){var e=Object(a.useState)(Object(i.a)(Object(i.a)({},S("standard",F)),{},{numberRowsFromTop:!1})),t=Object(l.a)(e,2),n=t[0],r=t[1];function c(e){x.setState(e),r(Object(i.a)(Object(i.a)({},n),e))}x||(x=new U(n));var d={canUndo:x.canUndo,canRedo:x.canRedo,undo:function(){r(x.undo())},redo:function(){r(x.redo())},restart:function(){r(x.restart())},numberRowsFromTop:n.numberRowsFromTop,setBoardLayout:function(e){c(S(e,F))},boardLayoutName:function(){return n.layoutName},clear:function(){c({boardLayout:n.boardLayout.copy().clearSquares()})},flip:function(){c({boardLayout:n.boardLayout.copy().reserveRows(),copyablePiecesTop:n.copyablePiecesBottom,copyablePiecesBottom:n.copyablePiecesTop,numberRowsFromTop:!n.numberRowsFromTop})},movePiece:function(e,t,a){var o=n.boardLayout.copy(),r=o.findCorePiecebyId(e);if(r)t===r.row&&a===r.col||(o.setCorePiece(t,a,r.piece),o.setCorePiece(r.row,r.col,null),c({boardLayout:o}));else{var i=function(e){var t=n.copyablePiecesTop.find((function(t){return t&&t.id===e}));return t||(t=n.copyablePiecesBottom.find((function(t){return t&&t.id===e}))),t}(e);if(!i)throw new Error("Piece with id ".concat(e," not found"));var l=F.copy(i);o.setCorePiece(t,a,l),c({boardLayout:o})}},dragEnd:function(e,t){if(!t){var a=n.boardLayout.findCorePiecebyId(e);if(a){var o=n.boardLayout.copy();o.setCorePiece(a.row,a.col,null),c({boardLayout:o})}}},dragBehaviour:function(e){var t=Boolean(n.boardLayout.findCorePiecebyId(e));return{move:t,copy:!t}}};return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,{backend:u.a},o.a.createElement("div",{className:"game"},o.a.createElement(q,{corePieces:n.copyablePiecesTop,gameOptions:d}),o.a.createElement(R,{layout:n.boardLayout,gameOptions:d}),o.a.createElement(q,{corePieces:n.copyablePiecesBottom,gameOptions:d}))),o.a.createElement(T,{gameOptions:d}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(36);var K=document.getElementById("root");c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(D,null)),K),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.134b5261.chunk.js.map