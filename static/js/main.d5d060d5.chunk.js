(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(21),c=n.n(r),i=n(6),l=n(39),s=n(25),u=n(22),d=n(27),f=n(3),p=n(4),m=function(){function e(t,n){if(Object(f.a)(this,e),this._corePieces=void 0,this._topLeftBlack=void 0,!(t instanceof Array&&"boolean"===typeof n))throw new Error("Bad input to BoardLayout");this._corePieces=t,this._topLeftBlack=n,Object.seal(this)}return Object(p.a)(e,[{key:"copy",value:function(){return new e(this._corePieces.map((function(e){return Object(d.a)(e)})),this._topLeftBlack)}},{key:"sanityCheckRowCol",value:function(e,t){if(void 0===this._corePieces[e][t])throw new Error("Invalid row or column number: ".concat(e," ").concat(t))}},{key:"setCorePiece",value:function(e,t,n){this.sanityCheckRowCol(e,t),this._corePieces[e][t]=n}},{key:"corePiece",value:function(e,t){return this.sanityCheckRowCol(e,t),this._corePieces[e][t]}},{key:"isBlack",value:function(e,t){return(e+t)%2===0?this._topLeftBlack:!this._topLeftBlack}},{key:"findCorePiecebyId",value:function(e){for(var t=0;t<this.nRows;++t)for(var n=0;n<this.nCols;++n){var a=this._corePieces[t][n];if(a&&a.id===e)return{row:t,col:n,piece:a}}return null}},{key:"clearSquares",value:function(){var e,t=Object(u.a)(this._corePieces);try{for(t.s();!(e=t.n()).done;){e.value.fill(null)}}catch(n){t.e(n)}finally{t.f()}return this}},{key:"reserveRows",value:function(){this._topLeftBlack=this.isBlack(this.nRows-1,0);for(var e=this._corePieces,t=0;t<this.nRows/2;++t)for(var n=this.nRows-(t+1),a=0;a<this.nCols;++a){var o=e[t][a];e[t][a]=e[n][a],e[n][a]=o}return this}},{key:"nRows",get:function(){return this._corePieces.length}},{key:"nCols",get:function(){return this._corePieces[0].length}}]),e}(),h=n(28),b=n(26),y=n(41),v="piece",k=n(40),P=n(23),w=n.n(P),g=function(e){var t=e.corePiece,n=e.gameOptions,a=Object(k.a)({item:{type:v,id:t.id},collect:function(e){return{isDragging:!!e.isDragging()}},end:function(e,a){return n.dragEnd(t.id,a.didDrop())}}),r=Object(i.a)(a,2),c=r[0].isDragging,l=r[1];return c&&n.dragBehaviour(t.id).move?null:o.a.createElement("div",{className:"piece-div",ref:l},o.a.createElement(w.a,{piece:t.name}))},E=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props.color,t=this.props.children,n="square";if(e)if("black"===e)n+=" black-square";else{if("white"!==e)throw new Error("Unrecognised square color: ".concat(e));n+=" white-square"}return o.a.createElement("div",{className:"square-placeholder"},o.a.createElement("div",{className:n},t))}}]),n}(o.a.PureComponent);function O(e){var t=e.corePiece,n=e.gameOptions,a=e.color,r=e.row,c=e.col,l=Object(y.a)({accept:v,drop:function(e){return n.movePiece(e.id,r,c)},collect:function(e){return{isOver:!!e.isOver()}}}),s=Object(i.a)(l,2)[1];return o.a.createElement("div",{ref:s,style:{position:"relative",width:"100%",height:"100%"}},o.a.createElement(E,{color:a},t?o.a.createElement(g,{corePiece:t,gameOptions:n}):null))}function _(e,t,n){var a=function(e){return n+"-"+e};t.push(o.a.createElement("div",{key:a("start")}));for(var r=0;r<e;++r)t.push(o.a.createElement("div",{key:a(r),className:"board-boarder board-boarder-letter"},String.fromCharCode(65+r)));t.push(o.a.createElement("div",{key:a("end")}))}function B(e,t,n,a){var r=function(e){return"r"+t+"-"+e},c=function(n){return o.a.createElement("div",{key:r(n),className:"board-boarder board-boarder-number"},e.nRows-t)},i=function(a){return o.a.createElement(O,{key:r(a),corePiece:e.corePiece(t,a),gameOptions:n,color:e.isBlack(t,a)?"black":"white",row:t,col:a})};a.push(c("start"));for(var l=0;l<e.nCols;++l)a.push(i(l));a.push(c("end"))}function C(e){var t=e.layout,n=e.gameOptions,a=t.nRows,r=t.nCols,c=[];_(r,c,"top");for(var i=0;i<a;++i){B(t,n.reverseRowOrder?a-1-i:i,n,c)}_(r,c,"bottom");var l={display:"grid",gridTemplateColumns:"repeat(".concat(r+2,",auto)"),gridTemplateRows:"repeat(".concat(a+2,",auto)")};return o.a.createElement("div",{className:"board",style:l},c)}var j=function e(t,n){Object(f.a)(this,e),this.name=void 0,this.id=void 0,this.id=n,this.name=t,Object.freeze(this)},R=function(){function e(){Object(f.a)(this,e),this._lastUsedId=void 0,this._lastUsedId=0}return Object(p.a)(e,[{key:"make",value:function(e){return++this._lastUsedId,new j(e,this._lastUsedId)}},{key:"copy",value:function(e){return this.make(e.name)}}]),e}(),L={standard:{copyableTop:["p","n","b","r","q","k"],board:[["r","n","b","q","k","b","n","r"],["p","p","p","p","p","p","p","p"],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],["P","P","P","P","P","P","P","P"],["R","N","B","Q","K","B","N","R"]],topLeftBlack:!1,copyableBottom:["P","N","B","R","Q","K"],displayName:"Standard"},fiveASide:{copyableTop:["p","n","b","r","q","k"],board:[["r","n","b","q","k"],["p","p","p","p","p"],[null,null,null,null,null],[null,null,null,null,null],["P","P","P","P","P"],["R","N","B","Q","K"]],topLeftBlack:!1,copyableBottom:["P","N","B","R","Q","K"],displayName:"5-a-side"},test:{copyableTop:["p"],board:[["p"],[null],["P"]],topLeftBlack:!1,copyableBottom:["P"],displayName:"test"}},N=Object.keys(L);var I=function(e){var t=e.gameOptions,n=t.boardLayoutName();return o.a.createElement("div",{className:"game-control"},o.a.createElement("div",{className:"game-type"},N.map((function(e){return o.a.createElement("div",{key:e},o.a.createElement("input",{type:"radio",name:"game-type",id:e,onChange:function(){return t.setBoardLayout(e)},checked:n===e}),o.a.createElement("label",{htmlFor:e},L[e].displayName.replace("o","&#8209;")))}))),o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{type:"button",onClick:function(){return t.clear()}}," Clear"),o.a.createElement("button",{type:"button",onClick:function(){return t.flip()}},"Flip")),o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{type:"button",disabled:!t.canUndo,onClick:function(){return t.undo()}},"Undo"),o.a.createElement("button",{type:"button",disabled:!t.canRedo,onClick:function(){return t.redo()}},"Redo"),o.a.createElement("button",{type:"button",disabled:!t.canUndo,onClick:function(){return t.restart()}},"Restart")))},U=n(18),S=function(){function e(t){Object(f.a)(this,e),this._states=void 0,this._stateIndex=void 0,this._states=[t],this._stateIndex=0}return Object(p.a)(e,[{key:"undo",value:function(){if(!this.canUndo)throw new Error("StateManager Cannot undo");return--this._stateIndex,this.state}},{key:"redo",value:function(){if(!this.canRedo)throw new Error("StateManager Cannot redo");return++this._stateIndex,this.state}},{key:"restart",value:function(){return this._stateIndex=0,this.state}},{key:"setState",value:function(e){this._states=this._states.slice(0,this._stateIndex+1),this._states.push(Object(U.a)(Object(U.a)({},this.state),e)),++this._stateIndex}},{key:"canUndo",get:function(){return this._stateIndex>0}},{key:"canRedo",get:function(){return this._stateIndex+1<this._states.length}},{key:"state",get:function(){return this._states[this._stateIndex]}}]),e}();function q(e){var t=e.corePieces,n=e.gameOptions;return o.a.createElement("div",{className:"row-of-pieces"},t.map((function(e,t){return o.a.createElement(E,{key:t},e?o.a.createElement(g,{corePiece:e,gameOptions:n}):null)})))}function x(e,t){var n=function(e){return e?t.make(e):null},a=L[e];if(!a)throw new Error("Unrecognised layout name: ".concat(e));var o=a.board.map((function(e){return e.map(n)}));return{copyablePiecesTop:a.copyableTop.map(n),boardLayout:new m(o,a.topLeftBlack),copyablePiecesBottom:a.copyableBottom.map(n),layoutName:e}}var T=function(){var e=Object(a.useRef)(new R).current;Object(a.useEffect)((function(){document.title="Chess"}),[]);var t=Object(a.useState)(x("standard",e)),n=Object(i.a)(t,2),r=n[0],c=n[1],u=Object(a.useState)(!1),d=Object(i.a)(u,2),f=d[0],p=d[1],m=Object(a.useRef)(new S(r)).current,h=function(e){m.setState(e),c(m.state)},b={canUndo:m.canUndo,canRedo:m.canRedo,undo:function(){c(m.undo())},redo:function(){c(m.redo())},restart:function(){c(m.restart())},reverseRowOrder:f,setBoardLayout:function(t){h(x(t,e))},boardLayoutName:function(){return r.layoutName},clear:function(){h({boardLayout:r.boardLayout.copy().clearSquares()})},flip:function(){p(!f)},movePiece:function(t,n,a){var o=r.boardLayout.copy(),c=o.findCorePiecebyId(t);if(c)n===c.row&&a===c.col||(o.setCorePiece(n,a,c.piece),o.setCorePiece(c.row,c.col,null),h({boardLayout:o}));else{var i=function(e){var t=r.copyablePiecesTop.find((function(t){return t&&t.id===e}));return t||(t=r.copyablePiecesBottom.find((function(t){return t&&t.id===e}))),t}(t);if(!i)throw new Error("Piece with id ".concat(t," not found"));var l=e.copy(i);o.setCorePiece(n,a,l),h({boardLayout:o})}},dragEnd:function(e,t){if(!t){var n=r.boardLayout.findCorePiecebyId(e);if(n){var a=r.boardLayout.copy();a.setCorePiece(n.row,n.col,null),h({boardLayout:a})}}},dragBehaviour:function(e){var t=Boolean(r.boardLayout.findCorePiecebyId(e));return{move:t,copy:!t}}},y=function(e){return(f?!e:e)?r.copyablePiecesTop:r.copyablePiecesBottom};return o.a.createElement(o.a.Fragment,null,o.a.createElement(l.a,{backend:s.a},o.a.createElement("div",{className:"game"},o.a.createElement(q,{corePieces:y(!0),gameOptions:b}),o.a.createElement(C,{layout:r.boardLayout,gameOptions:b}),o.a.createElement(q,{corePieces:y(!1),gameOptions:b}))),o.a.createElement(I,{gameOptions:b}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(36);var D=document.getElementById("root");c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(T,null)),D),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.d5d060d5.chunk.js.map